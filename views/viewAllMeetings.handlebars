<main>
    <div class="meetings-dashboard">
        <div class="title-bar">
            <h1 class="page-title">{{title}}</h1>
            <div class="title-bar-actions">
                <button id="create-meeting">+ Create Meeting</button>
            </div>
        </div>

        <aside class="bookings-sidebar">
            <h3>My Bookings</h3>
            <label class="sidebar-checkbox"> <input type="checkbox" id="toggle-past-meetings" /> Show Past Meetings </label>

            <ul class="booked-meetings-list">
                {{#each myBookings}}
                <li class="booking-item" data-id="{{this._id}}">
                    <div class="booking-title">{{this.name}}</div>
                    <div class="booking-datetime">{{this.bookingDate}} : {{this.bookingStart}} - {{this.bookingEnd}}</div>
                </li>
                {{/each}}
            </ul>
        </aside>

        <section class="meetings-main-content">
            <h2>My Meetings</h2>
            <div class="meetings-grid" id="my-meetings">
                {{#each myMeetings}} {{!-- Mark each card with meeting id for clickability--}}
                <div class="meeting-card" data-id="{{this._id}}">
                    <h3 class="meeting-title" title="{{this.name}}">{{this.name}}</h3>
                    <div class="meeting-info">
                        <p class="status status-{{bookingStatus}}">Status: {{bookingStatus}}</p>
                        <p>Respondents: {{this.responses.length}}</p>
                        <p>Duration: {{this.duration}}h</p>
                        <p>Meeting Date: {{#if this.endDate}}{{this.startDate}} - {{this.endDate}} {{else}}{{this.startDate}} {{/if}}</p>
                    </div>
                    <div class="mini-calendar-wrapper">
                        <div class="mini-calendar" style="--day-count: {{meeting.length}}">
                            {{#each this.matrix}}
                            <div class="mini-calendar-column">
                                {{!-- Only cells, no headers --}}
                                <div class="mini-calendar-cells">
                                    {{#each this}}
                                    <div class="mini-timeslot" style="background-color: rgba(106, 90, 205, {{multiplyOpacity this}});"></div>
                                    {{/each}}
                                </div>
                            </div>
                            {{/each}}
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>

            <h2>My Responses</h2>
            <div class="meetings-grid" id="responded-meetings">
                {{#each myResponses}}
                <div class="meeting-card" data-id="{{this._id}}">
                    <h3 class="meeting-title" title="{{this.name}}">{{this.name}}</h3>
                    <div class="meeting-info">
                        <p class="status status-{{bookingStatus}}">Status: {{bookingStatus}}</p>
                        <p>Owner: {{this.owner}}</p>
                        <p>Respondents: {{this.responses.length}}</p>
                        <p>Duration: {{this.duration}}h</p>
                        <p>Meeting Date: {{#if this.endDate}}{{this.startDate}} - {{this.endDate}} {{else}}{{this.startDate}} {{/if}}</p>
                    </div>
                    <div class="mini-calendar-wrapper">
                        <div class="mini-calendar" style="--day-count: {{meeting.length}}">
                            {{#each this.matrix}}
                            <div class="mini-calendar-column">
                                {{!-- Only cells, no headers --}}
                                <div class="mini-calendar-cells">
                                    {{#each this}}
                                    <div class="mini-timeslot" style="background-color: rgba(106, 90, 205, {{multiplyOpacity this}});"></div>
                                    {{/each}}
                                </div>
                            </div>
                            {{/each}}
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
        </section>
    </div>
</main>
<script src="../../public/js/dashboard.js"></script>
